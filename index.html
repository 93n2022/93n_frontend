<!DOCTYPE html>
<html>
  <head>
    <title>93N</title>
    <script src="https://aloycwl.github.io/js/cdn/jquery.min.js"></script>
    <script src="https://aloycwl.github.io/js/cdn/web3.min.js"></script>
    <script src="https://aloycwl.github.io/js/cdn/web3ac.js"></script>
    <style>
      .hide {
        display: none;
      }
      a {
        cursor: pointer;
        color: blue;
        text-decoration: underline;
      }
      input {
        width: 350px;
        cursor: pointer;
        background-color: #eeeeee;
      }
      i {
        font-size: small;
      }
    </style>
  </head>
  <body>
    <a id="connect" onclick="connect()">Connect</a>
    <div id="root" class="hide">
      <h1>Step 1</h1>
      <ol>
        <li>Connect to Rinkeby Test Network</li>
        <li>
          Get test token from faucet as gas fee -
          <a href="https://rinkebyfaucet.com/" target="_blank"
            >https://rinkebyfaucet.com/</a
          >
        </li>
        <li>
          Claim MOCK-USDT to deposit -
          <a onclick="claim()">click here</a>
        </li>
        <li>Your USDT Token: <span id="txtUSDT"></span></li>
        <li>Your 93N Token: <span id="txt93N"></span></li>
      </ol>
      <h1>Step 2</h1>
      <ol>
        <li>Approval to transfer USDT to contract.</li>
        <li>
          10,000 USDT x
          <select id="num">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="4">5</option>
            <option value="4">6</option>
            <option value="4">7</option>
            <option value="4">8</option>
            <option value="4">9</option>
            <option value="4">10</option>
          </select>
          in
          <select id="months">
            <option value="3">3</option>
            <option value="6">6</option>
            <option value="7">9</option>
          </select>
          months - <a onclick="deposit()">Deposit</a>
        </li>
        <li id="status"></li>
      </ol>

      Referred by: <span id="txtRB"></span><br /><br />
      <a onclick="deposit()">Deposit</a> - Approval first - Deposit next
      <br /><br />
      Referral link (click to copy):
      <input
        readonly
        id="txtRef"
        onclick="navigator.clipboard.writeText($(location).attr('host')+'#'+$(this).val());$('#copied').show()"
      />
      <i id="copied" class="hide">Copied</i><br /><br />
      <a onclick="stake()">Staking update</a><br /><br />
      <p id="p1">USDT available:</p>
      <p id="p2">User's info:</p>
      <p id="p3">Downlines:</p>
    </div>
  </body>
  <script>
    CHAIN = 4;
    CS = 'https://aloycwl.github.io/93n_frontend/css/93n.css';
    CA = '0x00691081759EF9C21199881F45Bec32f381C4128';
    CA2 = '0xA952Fb1E68Cf0688E4C9474aBDE961Ed6b52151E';
    async function display() {
      $('#txtRB').html(_R());
      $('#txtRef').val(acct);
      $('#root').show();
      $('#connect').hide();
    }
    async function deposit() {
      oamt = 10000 * $('#num').val() * 1e18;
      amt = (10000 * $('#num').val() * 1e18).toLocaleString('fullwide', {
        useGrouping: false,
      });
      if (oamt > balUSDT) {
        $('#status').html('Insufficient USDT');
        return;
      }
      $('#status').html('Approving...');
      await contract2.approve(CA, amt).send(FA);
      $('#status').html('Depositing...');
      await contract.Deposit(acct, amt, $('#months').val()).send(FA);
      $('#status').html('Deposited Successfully');
    }
    async function stake() {
      await contract.Staking().send(FA);
      location.reload();
    }
    async function connect() {
      await load(
        [
          {
            inputs: [u3, u1, u1],
            name: 'Deposit',
            outputs: [],
            stateMutability: 'payable',
            type: 'function',
          },
          {
            inputs: [],
            name: 'Staking',
            outputs: [],
            stateMutability: 'nonpayable',
            type: 'function',
          },
          {
            inputs: [u3],
            name: 'getDownlines',
            outputs: [u4],
            stateMutability: 'view',
            type: 'function',
          },
          {
            inputs: [u3],
            name: 'user',
            outputs: [u3, u1, u1, u1, u1, u1],
            stateMutability: 'view',
            type: 'function',
          },
        ],
        CA
      );
      await load2();
      contract3 = new web3.Contract(
        [
          {
            inputs: [u3],
            name: 'balanceOf',
            outputs: [u1],
            stateMutability: 'view',
            type: 'function',
          },
          {
            inputs: [u3, u1],
            name: 'approve',
            outputs: [],
            stateMutability: 'nonpayable',
            type: 'function',
          },
          {
            inputs: [u3],
            name: 'MINT',
            outputs: [],
            stateMutability: 'nonpayable',
            type: 'function',
          },
        ],
        '0x129E44F2157A2819e37924f02eFCfFE2e9d409B9'
      );
      contract3 = contract3.methods;
      await disUSDT();
      display();
    }

    async function claim() {
      await contract3.MINT(acct).send(FA);
      disUSDT();
    }
    async function disUSDT() {
      balUSDT = (
        (await contract3.balanceOf(acct).call()) / 1e18
      ).toLocaleString('en-US');
      bal93N = ((await LB()) / 1e18).toLocaleString('en-US');
      $('#txtUSDT').html(balUSDT);
      $('#txt93N').html(bal93N);
    }
  </script>
</html>
